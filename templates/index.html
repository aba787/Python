
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cyberattack Detection Dashboard</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            margin: 0;
            padding: 20px;
            background: #1a1a1a;
            color: #ffffff;
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .header h1 {
            color: #ff6b6b;
            margin-bottom: 10px;
        }
        
        .controls {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .btn {
            padding: 10px 15px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            transition: background-color 0.3s;
        }
        
        .btn-danger { background: #ff4757; color: white; }
        .btn-warning { background: #ffa502; color: white; }
        .btn-info { background: #3742fa; color: white; }
        .btn-secondary { background: #747d8c; color: white; }
        
        .btn:hover { opacity: 0.8; }
        
        .dashboard-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .stats-panel, .chart-panel {
            background: #2c2c2c;
            padding: 20px;
            border-radius: 8px;
            border: 1px solid #444;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }
        
        .stat-card {
            background: #333;
            padding: 15px;
            border-radius: 5px;
            text-align: center;
            border: 1px solid #555;
        }
        
        .stat-number {
            font-size: 2em;
            font-weight: bold;
        }
        
        .stat-high { color: #ff4757; }
        .stat-medium { color: #ffa502; }
        .stat-low { color: #2ed573; }
        .stat-info { color: #70a1ff; }
        
        .alerts-table {
            background: #2c2c2c;
            border-radius: 8px;
            overflow: hidden;
            border: 1px solid #444;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
        }
        
        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #444;
        }
        
        th {
            background: #333;
            font-weight: bold;
        }
        
        .level-HIGH { color: #ff4757; font-weight: bold; }
        .level-MEDIUM { color: #ffa502; font-weight: bold; }
        .level-LOW { color: #2ed573; }
        .level-INFO { color: #70a1ff; }
        
        .status {
            padding: 10px;
            background: #2c2c2c;
            border-radius: 5px;
            margin-bottom: 20px;
            border: 1px solid #444;
        }
        
        @media (max-width: 768px) {
            .dashboard-grid {
                grid-template-columns: 1fr;
            }
            .stats-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>üõ°Ô∏è Cyberattack Detection Dashboard</h1>
        <p>Real-time Security Monitoring System</p>
    </div>

    <div class="status">
        <strong>Status:</strong> <span id="status">System Active</span> | 
        <strong>Last Update:</strong> <span id="lastUpdate">Never</span>
    </div>

    <div class="controls">
        <button class="btn btn-danger" onclick="triggerScenario('sql_injection')">SQL Injection</button>
        <button class="btn btn-danger" onclick="triggerScenario('syn_flood')">SYN Flood</button>
        <button class="btn btn-warning" onclick="triggerScenario('phishing_email')">Phishing Email</button>
        <button class="btn btn-warning" onclick="triggerScenario('port_scan')">Port Scan</button>
        <button class="btn btn-danger" onclick="triggerScenario('malware_beacon')">Malware Beacon</button>
        <button class="btn btn-secondary" onclick="clearAlerts()">Clear Alerts</button>
    </div>

    <div class="dashboard-grid">
        <div class="stats-panel">
            <h3>üìä Alert Statistics</h3>
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-number stat-high" id="highCount">0</div>
                    <div>HIGH</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number stat-medium" id="mediumCount">0</div>
                    <div>MEDIUM</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number stat-low" id="lowCount">0</div>
                    <div>LOW</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number stat-info" id="infoCount">0</div>
                    <div>INFO</div>
                </div>
            </div>
        </div>

        <div class="chart-panel">
            <h3>üìà Alert Distribution</h3>
            <div id="alertChart"></div>
        </div>
    </div>

    <div class="alerts-table">
        <h3 style="margin: 0; padding: 15px; background: #333;">üö® Recent Alerts</h3>
        <table>
            <thead>
                <tr>
                    <th>Time</th>
                    <th>Level</th>
                    <th>Message</th>
                </tr>
            </thead>
            <tbody id="alertsTableBody">
                <tr>
                    <td colspan="3" style="text-align: center; padding: 20px;">Loading alerts...</td>
                </tr>
            </tbody>
        </table>
    </div>

    <script>
        let alertsData = [];

        function updateAlerts() {
            fetch('/api/alerts')
                .then(response => response.json())
                .then(alerts => {
                    alertsData = alerts;
                    displayAlerts(alerts);
                    document.getElementById('lastUpdate').textContent = new Date().toLocaleTimeString();
                })
                .catch(error => {
                    console.error('Error fetching alerts:', error);
                    document.getElementById('status').textContent = 'Connection Error';
                });
        }

        function updateStats() {
            fetch('/api/stats')
                .then(response => response.json())
                .then(stats => {
                    document.getElementById('highCount').textContent = stats.HIGH || 0;
                    document.getElementById('mediumCount').textContent = stats.MEDIUM || 0;
                    document.getElementById('lowCount').textContent = stats.LOW || 0;
                    document.getElementById('infoCount').textContent = stats.INFO || 0;
                    updateChart(stats);
                })
                .catch(error => console.error('Error fetching stats:', error));
        }

        function displayAlerts(alerts) {
            const tbody = document.getElementById('alertsTableBody');
            if (alerts.length === 0) {
                tbody.innerHTML = '<tr><td colspan="3" style="text-align: center; padding: 20px;">No alerts found</td></tr>';
                return;
            }

            tbody.innerHTML = alerts.map(alert => {
                const time = new Date(alert.timestamp).toLocaleTimeString();
                return `
                    <tr>
                        <td>${time}</td>
                        <td><span class="level-${alert.level}">${alert.level}</span></td>
                        <td>${alert.message}</td>
                    </tr>
                `;
            }).join('');
        }

        function updateChart(stats) {
            const data = [{
                values: Object.values(stats),
                labels: Object.keys(stats),
                type: 'pie',
                marker: {
                    colors: ['#ff4757', '#ffa502', '#2ed573', '#70a1ff']
                }
            }];

            const layout = {
                paper_bgcolor: 'rgba(0,0,0,0)',
                plot_bgcolor: 'rgba(0,0,0,0)',
                font: { color: '#ffffff' },
                margin: { t: 10, b: 10, l: 10, r: 10 }
            };

            Plotly.newPlot('alertChart', data, layout, {displayModeBar: false});
        }

        function triggerScenario(scenario) {
            fetch('/api/trigger', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({scenario: scenario})
            })
            .then(response => response.json())
            .then(result => {
                if (result.success) {
                    document.getElementById('status').textContent = `Triggered: ${scenario}`;
                    setTimeout(() => {
                        updateAlerts();
                        updateStats();
                    }, 1000);
                }
            })
            .catch(error => console.error('Error triggering scenario:', error));
        }

        function clearAlerts() {
            fetch('/api/clear', {method: 'POST'})
                .then(response => response.json())
                .then(result => {
                    if (result.success) {
                        updateAlerts();
                        updateStats();
                        document.getElementById('status').textContent = 'Alerts cleared';
                    }
                })
                .catch(error => console.error('Error clearing alerts:', error));
        }

        // Update data every 3 seconds
        setInterval(() => {
            updateAlerts();
            updateStats();
        }, 3000);

        // Initial load
        updateAlerts();
        updateStats();
    </script>
</body>
</html>
